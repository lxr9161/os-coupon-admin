(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59f7d824"],{2118:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{ref:"upload",attrs:{action:t.action,accept:t.acceptTypes.join(","),limit:1,"before-upload":t.beforeUpload,"on-progress":t.onProgress,"on-success":t.onSuccess,"on-error":t.onError,headers:t.headers,data:t.uploadData,name:"file","show-file-list":!1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),a("div",{staticClass:"el-upload__tip nl-upload_tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过3mb")])],1),a("div",{staticClass:"nl_upload-img"},[t.img?a("img",{staticClass:"nl_upload-img",attrs:{src:t.img}}):t._e()])],1)},o=[],s=(a("b0c0"),a("ac1f"),a("a78e")),n=a.n(s),r=a("3439"),l={props:["file"],data:function(){return{headers:{Authorization:"bearer "+n.a.get("auth_token")},acceptTypes:["image/png","image/jpeg"],action:r["b"],img:"",host:r["a"],loading:!1,uploadData:{token:"",key:""}}},mounted:function(){this.file&&(this.img=this.host+this.file),this.getUploadToken()},watch:{file:function(t){this.img=t?this.host+t:t}},methods:{getUploadToken:function(){var t=this;this.$http.get("/backend/getQiniuUploadToken").then((function(e){"success"===e.data.status&&(t.uploadData.token=e.data.info.token)}))},generateFileName:function(t){var e=this.getExt(t);return"images/"+this.randomNumber(1)+Date.parse(new Date)+this.randomNumber(4)+e},randomNumber:function(t){for(var e="",a=1;a<=t;a++)e+=parseInt(10*Math.random());return e},getExt:function(t){var e=/\.[^.]+/.exec(t);return e},beforeUpload:function(t){return!this.loading&&(!!this.uploadData.token&&(this.uploadData.key=this.generateFileName(t.name),console.log(this.uploadData),void(this.loading=!0)))},onProgress:function(){},onSuccess:function(t){t.key?(this.$emit("update:file",t.key),this.img=this.host+t.key):this.$message({message:"上传图片失败",type:"error"}),this.loading=!1,this.$refs.upload.clearFiles()},onError:function(){this.loading=!1,this.$refs.upload.clearFiles(),this.$message({message:"上传图片失败",type:"error"})}}},c=l,u=(a("e154"),a("2877")),d=Object(u["a"])(c,i,o,!1,null,null,null);e["a"]=d.exports},3439:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return o}));var i="http://statics.nulizhe.com/",o="https://upload.qiniup.com"},6005:function(t,e,a){},e154:function(t,e,a){"use strict";var i=a("6005"),o=a.n(i);o.a},efeb:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"pd-20"},[a("div",{staticClass:"mb-10"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("添加优惠券")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"","header-row-class-name":"yun-table-header",data:t.tableData}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),a("el-table-column",{attrs:{prop:"name",label:"优惠券名称"}}),a("el-table-column",{attrs:{label:"icon",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"80px"},attrs:{src:t.host+e.row.icon}})]}}])}),a("el-table-column",{attrs:{label:"排序",prop:"sort",width:"100"}}),a("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("span",{staticClass:"yun-red"},[t._v("禁用")]):t._e(),1===e.row.status?a("span",{staticClass:"yun-green"},[t._v("启用")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"时间",width:"230"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("创建时间: "+t._s(t._f("date")(e.row.created_at,"T")))]),a("div",[t._v("更新时间: "+t._s(t._f("date")(e.row.updated_at,"T")))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.edit(e.row)}}},[t._v("编辑")])]}}])})],1),a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"prev, pager, next, jumper",total:t.total,"hide-on-single-page":""},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.getList}}),a("el-dialog",{attrs:{title:this.form.id?"编辑优惠券":"添加优惠券",visible:t.dialogVisible,width:"800px"},on:{"update:visible":function(e){t.dialogVisible=e},closed:t.init}},[a("el-form",{attrs:{model:t.form,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"优惠券名称",prop:"name"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"icon"}},[a("upload-qiniu",{attrs:{file:t.form.icon},on:{"update:file":function(e){return t.$set(t.form,"icon",e)}}})],1),a("el-form-item",{attrs:{label:"优惠券封面"}},[a("upload-qiniu",{attrs:{file:t.form.cover},on:{"update:file":function(e){return t.$set(t.form,"cover",e)}}})],1),a("el-form-item",{attrs:{label:"跳转地址"}},[a("el-input",{model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}})],1),a("el-form-item",{attrs:{label:"跳转小程序appid"}},[a("el-input",{model:{value:t.form.appid,callback:function(e){t.$set(t.form,"appid",e)},expression:"form.appid"}})],1),a("el-form-item",{attrs:{label:"优惠价价值"}},[a("el-input",{model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),a("el-form-item",{attrs:{label:"子标题"}},[a("el-input",{model:{value:t.form.sub_title,callback:function(e){t.$set(t.form,"sub_title",e)},expression:"form.sub_title"}})],1),a("el-form-item",{attrs:{label:"排序值"}},[a("el-input",{model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{label:"分享按钮"}},[a("el-switch",{attrs:{"inactive-value":0,"active-value":1,"active-text":"显示","inactive-text":"隐藏"},model:{value:t.form.share_btn,callback:function(e){t.$set(t.form,"share_btn",e)},expression:"form.share_btn"}})],1),a("el-form-item",{attrs:{label:"分享页面文案"}},[a("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.form.share_text,callback:function(e){t.$set(t.form,"share_text",e)},expression:"form.share_text"}})],1),a("el-form-item",{attrs:{label:"是否首页展示"}},[a("el-switch",{attrs:{"inactive-value":0,"active-value":1,"active-text":"是","inactive-text":"否"},model:{value:t.form.index_show,callback:function(e){t.$set(t.form,"index_show",e)},expression:"form.index_show"}})],1),a("el-form-item",{attrs:{label:"是否跳转领取页面"}},[a("el-switch",{attrs:{"inactive-value":0,"active-value":1,"active-text":"是","inactive-text":"否"},model:{value:t.form.jump_get_page,callback:function(e){t.$set(t.form,"jump_get_page",e)},expression:"form.jump_get_page"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio",{attrs:{label:1},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[t._v("启用")]),a("el-radio",{attrs:{label:0},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[t._v("禁用")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")])],1)],1)],1)])},o=[],s=a("2118"),n=a("3439"),r={name:"",icon:"",cover:"",price:0,sort:0,share_btn:0,index_show:0,jump_get_page:0,status:1,link:"",appid:"",share_text:"",sub_title:""},l={components:{UploadQiniu:s["a"]},data:function(){return{host:n["a"],loading:!1,tableData:[],config:[],currentPage:1,pageSize:10,total:0,dialogVisible:!1,saveLoading:!1,form:JSON.parse(JSON.stringify(r))}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.$http.get("/backend/coupon",{params:{page:this.currentPage}}).then((function(e){t.tableData=e.data.data,t.currentPage=e.data.current_page,t.total=e.data.total,t.pageSize=e.data.per_page,t.loading=!1})).catch((function(){t.loading=!1}))},save:function(){var t=this;if(!this.saveLoading){this.saveLoading=!0;var e=null;e=this.form.id?this.$http.put("backend/coupon/"+this.form.id,this.form):this.$http.post("/backend/coupon",this.form),e.then((function(e){"success"===e.data.status&&(t.$message({message:e.data.info,type:"success"}),t.getList(),t.init(),t.dialogVisible=!1),t.saveLoading=!1})).catch((function(){t.saveLoading=!1}))}},edit:function(t){var e=this;this.saveLoading=!0,this.dialogVisible=!0,this.$http.get("/backend/coupon/"+t.id).then((function(t){e.saveLoading=!1,t.data.info?e.form=t.data.info:(e.dialogVisible=!1,e.$message({message:"未找到记录",type:"error"}))})).catch((function(){e.dialogVisible=!1,e.$message({message:"未找到记录",type:"error"})}))},del:function(t){var e=this;this.$http.delete("/backend/admin/"+t).then((function(t){"success"===t.data.status&&(e.$message({message:t.data.info,type:"success"}),e.getList())}))},init:function(){this.form=JSON.parse(JSON.stringify(r))}}},c=l,u=a("2877"),d=Object(u["a"])(c,i,o,!1,null,"799535e4",null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-59f7d824.fcabfe63.js.map