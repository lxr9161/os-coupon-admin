(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f833d9e"],{2118:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{ref:"upload",attrs:{action:t.action,accept:t.acceptTypes.join(","),limit:1,"before-upload":t.beforeUpload,"on-progress":t.onProgress,"on-success":t.onSuccess,"on-error":t.onError,headers:t.headers,data:t.uploadData,name:"file","show-file-list":!1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),a("div",{staticClass:"el-upload__tip nl-upload_tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过3mb")])],1),a("div",{staticClass:"nl_upload-img"},[t.img?a("img",{staticClass:"nl_upload-img",attrs:{src:t.img}}):t._e()])],1)},n=[],s=(a("b0c0"),a("ac1f"),a("a78e")),i=a.n(s),l=a("3439"),r={props:["file"],data:function(){return{headers:{Authorization:"bearer "+i.a.get("auth_token")},acceptTypes:["image/png","image/jpeg"],action:l["b"],img:"",host:l["a"],loading:!1,uploadData:{token:"",key:""}}},mounted:function(){this.file&&(this.img=this.host+this.file),this.getUploadToken()},watch:{file:function(t){this.img=t?this.host+t:t}},methods:{getUploadToken:function(){var t=this;this.$http.get("/backend/getQiniuUploadToken").then((function(e){"success"===e.data.status&&(t.uploadData.token=e.data.info.token)}))},generateFileName:function(t){var e=this.getExt(t);return"images/"+this.randomNumber(1)+Date.parse(new Date)+this.randomNumber(4)+e},randomNumber:function(t){for(var e="",a=1;a<=t;a++)e+=parseInt(10*Math.random());return e},getExt:function(t){var e=/\.[^.]+/.exec(t);return e},beforeUpload:function(t){return!this.loading&&(!!this.uploadData.token&&(this.uploadData.key=this.generateFileName(t.name),console.log(this.uploadData),void(this.loading=!0)))},onProgress:function(){},onSuccess:function(t){t.key?(this.$emit("update:file",t.key),this.img=this.host+t.key):this.$message({message:"上传图片失败",type:"error"}),this.loading=!1,this.$refs.upload.clearFiles()},onError:function(){this.loading=!1,this.$refs.upload.clearFiles(),this.$message({message:"上传图片失败",type:"error"})}}},u=r,c=(a("e154"),a("2877")),p=Object(c["a"])(u,o,n,!1,null,null,null);e["a"]=p.exports},3439:function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return n}));var o="http://statics.nulizhe.com/",n="https://upload.qiniup.com"},"34f3":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pd-20"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"","header-row-class-name":"yun-table-header",data:t.config,"row-key":"row"}},[a("el-table-column",{attrs:{prop:"title",label:"奖品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"small"},model:{value:e.row.title,callback:function(a){t.$set(e.row,"title",a)},expression:"scope.row.title"}})]}}])}),a("el-table-column",{attrs:{label:"图片"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("upload-qiniu",{attrs:{file:e.row.img_url},on:{"update:file":function(a){return t.$set(e.row,"img_url",a)}}})]}}])}),a("el-table-column",{attrs:{label:"奖品类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{size:"small"},model:{value:e.row.type,callback:function(a){t.$set(e.row,"type",a)},expression:"scope.row.type"}},[a("el-option",{attrs:{value:1,label:"贝壳"}}),a("el-option",{attrs:{value:2,label:"真实奖品"}}),a("el-option",{attrs:{value:3,label:"代金券"}}),a("el-option",{attrs:{value:4,label:"未中奖"}})],1)]}}])}),a("el-table-column",{attrs:{label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.type||3===e.row.type?a("el-input",{attrs:{size:"small"},model:{value:e.row.reward_price,callback:function(a){t.$set(e.row,"reward_price",a)},expression:"scope.row.reward_price"}}):t._e(),3===e.row.type?a("div",{staticClass:"yun-form-note"},[t._v("单位分")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"抽奖概率"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{size:"small"},model:{value:e.row.probability,callback:function(a){t.$set(e.row,"probability",a)},expression:"scope.row.probability"}})]}}])}),a("el-table-column",{attrs:{label:"排序"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{size:"small"},model:{value:e.row.sort,callback:function(a){t.$set(e.row,"sort",a)},expression:"scope.row.sort"}})]}}])})],1),a("div",{staticClass:"mt-10"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.save}},[t._v("保存")])],1)],1)},n=[],s=a("2118"),i={components:{UploadQiniu:s["a"]},data:function(){return{loading:!1,config:[]}},mounted:function(){this.getDrawConfig()},methods:{getDrawConfig:function(){var t=this;this.$http.get("/backend/getDrawConfig").then((function(e){"success"===e.data.status&&(t.config=e.data.info)}))},save:function(){var t=this;this.loading||(this.loading=!0,this.$http.post("/backend/saveDrawConfig",{config:this.config}).then((function(e){"success"===e.data.status&&t.$message({type:"success",message:"保存成功"}),t.loading=!1})).catch((function(){t.loading=!1})))}}},l=i,r=a("2877"),u=Object(r["a"])(l,o,n,!1,null,null,null);e["default"]=u.exports},6005:function(t,e,a){},e154:function(t,e,a){"use strict";var o=a("6005"),n=a.n(o);n.a}}]);
//# sourceMappingURL=chunk-5f833d9e.f21bf9ad.js.map