(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f182386"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},2118:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{ref:"upload",attrs:{action:t.action,accept:t.acceptTypes.join(","),limit:1,"before-upload":t.beforeUpload,"on-progress":t.onProgress,"on-success":t.onSuccess,"on-error":t.onError,headers:t.headers,data:t.uploadData,name:"file","show-file-list":!1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),a("div",{staticClass:"el-upload__tip nl-upload_tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过3mb")])],1),a("div",{staticClass:"nl_upload-img"},[t.img?a("img",{staticClass:"nl_upload-img",attrs:{src:t.img}}):t._e()])],1)},i=[],s=(a("b0c0"),a("ac1f"),a("a78e")),n=a.n(s),r=a("3439"),l={props:["file"],data:function(){return{headers:{Authorization:"bearer "+n.a.get("auth_token")},acceptTypes:["image/png","image/jpeg"],action:r["b"],img:"",host:r["a"],loading:!1,uploadData:{token:"",key:""}}},mounted:function(){this.file&&(this.img=this.host+this.file),this.getUploadToken()},watch:{file:function(t){this.img=t?this.host+t:t}},methods:{getUploadToken:function(){var t=this;this.$http.get("/backend/getQiniuUploadToken").then((function(e){"success"===e.data.status&&(t.uploadData.token=e.data.info.token)}))},generateFileName:function(t){var e=this.getExt(t);return"images/"+this.randomNumber(1)+Date.parse(new Date)+this.randomNumber(4)+e},randomNumber:function(t){for(var e="",a=1;a<=t;a++)e+=parseInt(10*Math.random());return e},getExt:function(t){var e=/\.[^.]+/.exec(t);return e},beforeUpload:function(t){return!this.loading&&(!!this.uploadData.token&&(this.uploadData.key=this.generateFileName(t.name),console.log(this.uploadData),void(this.loading=!0)))},onProgress:function(){},onSuccess:function(t){t.key?(this.$emit("update:file",t.key),this.img=this.host+t.key):this.$message({message:"上传图片失败",type:"error"}),this.loading=!1,this.$refs.upload.clearFiles()},onError:function(){this.loading=!1,this.$refs.upload.clearFiles(),this.$message({message:"上传图片失败",type:"error"})}}},c=l,u=(a("e154"),a("2877")),p=Object(u["a"])(c,o,i,!1,null,null,null);e["a"]=p.exports},3439:function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return i}));var o="http://statics.nulizhe.com/",i="https://upload.qiniup.com"},6005:function(t,e,a){},"841c":function(t,e,a){"use strict";var o=a("d784"),i=a("825a"),s=a("1d80"),n=a("129f"),r=a("14c3");o("search",1,(function(t,e,a){return[function(e){var a=s(this),o=void 0==e?void 0:e[t];return void 0!==o?o.call(e,a):new RegExp(e)[t](String(a))},function(t){var o=a(e,t,this);if(o.done)return o.value;var s=i(t),l=String(this),c=s.lastIndex;n(c,0)||(s.lastIndex=0);var u=r(s,l);return n(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]}))},ccb7:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"pd-20"},[a("div",{staticClass:"yun-list-search-area mb-10"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.search}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"广告位"},model:{value:t.search.code,callback:function(e){t.$set(t.search,"code",e)},expression:"search.code"}},t._l(t.positionCode,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getList}},[t._v("查询")])],1)],1)],1),a("div",{staticClass:"mb-10"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("添加广告")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"","header-row-class-name":"yun-table-header",data:t.tableData}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),a("el-table-column",{attrs:{prop:"position",label:"位置",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.positionCode[e.row.position])+" ")]}}])}),a("el-table-column",{attrs:{label:"广告图片",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"120px"},attrs:{src:t.host+e.row.img_url}})]}}])}),a("el-table-column",{attrs:{label:"广告链接",prop:"link"}}),a("el-table-column",{attrs:{label:"链接类型",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.type?a("span",{staticClass:"yun-green"},[t._v("小程序")]):t._e(),2===e.row.type?a("span",{staticClass:"yun-red"},[t._v("H5")]):t._e(),3===e.row.type?a("span",{staticClass:"yun-red"},[t._v("优惠券链接")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("date")(e.row.created_at,"T"))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.edit(e.row)}}},[t._v("编辑")]),a("el-popconfirm",{staticClass:"ml-10",attrs:{icon:"el-icon-info",iconColor:"red",title:"确定删除吗？"},on:{confirm:function(a){return t.del(e.row.id)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",size:"small"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"prev, pager, next, jumper",total:t.total,"hide-on-single-page":""},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.getList}}),a("el-dialog",{attrs:{title:this.form.id?"编辑广告":"添加广告",visible:t.dialogVisible,width:"600px"},on:{"update:visible":function(e){t.dialogVisible=e},closed:t.init}},[a("el-form",{attrs:{model:t.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"位置",prop:"position"}},[a("el-select",{model:{value:t.form.position,callback:function(e){t.$set(t.form,"position",e)},expression:"form.position"}},t._l(t.positionCode,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"跳转链接类型",prop:"type"}},[a("el-select",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-option",{attrs:{value:1,label:"小程序"}}),a("el-option",{attrs:{value:2,label:"H5"}}),a("el-option",{attrs:{value:3,label:"跳转优惠券"}})],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3===t.form.type,expression:"form.type === 3"}],attrs:{label:"优惠券id"}},[a("el-input",{model:{value:t.form.coupon_id,callback:function(e){t.$set(t.form,"coupon_id",e)},expression:"form.coupon_id"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===t.form.type,expression:"form.type === 1"}],attrs:{label:"跳转方式",prop:"type"}},[a("el-select",{model:{value:t.form.target,callback:function(e){t.$set(t.form,"target",e)},expression:"form.target"}},[a("el-option",{attrs:{value:0,label:"内部跳转"}}),a("el-option",{attrs:{value:1,label:"跳转到其他小程序"}})],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===t.form.type&&1===t.form.target,expression:"form.type === 1 && form.target ===1"}],attrs:{label:"跳转小程序appid"}},[a("el-input",{model:{value:t.form.appid,callback:function(e){t.$set(t.form,"appid",e)},expression:"form.appid"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===t.form.type||2===t.form.type,expression:"form.type === 1 || form.type === 2"}],attrs:{label:"跳转链接",prop:"link"}},[a("el-input",{model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}})],1),a("el-form-item",{attrs:{label:"图片",prop:"img_url"}},[a("upload-qiniu",{attrs:{file:t.form.img_url},on:{"update:file":function(e){return t.$set(t.form,"img_url",e)}}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio",{attrs:{label:1},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[t._v("启用")]),a("el-radio",{attrs:{label:0},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[t._v("禁用")])],1),a("el-form-item",{attrs:{label:"排序值"}},[a("el-input-number",{model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")])],1)],1)],1)])},i=[],s=(a("ac1f"),a("841c"),a("3439")),n=a("2118"),r={position:"",img_url:"",link:"",status:1,sort:0,type:"",appid:"",target:0,coupon_id:""},l={components:{UploadQiniu:n["a"]},data:function(){return{search:{code:""},loading:!1,tableData:[],currentPage:1,pageSize:10,total:0,dialogVisible:!1,saveLoading:!1,form:JSON.parse(JSON.stringify(r)),positionCode:{index:"首页banner",coupon:"优惠券页面顶部banner"},host:s["a"]}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.$http.get("/backend/ad",{params:this.search}).then((function(e){t.tableData=e.data.info,t.loading=!1})).catch((function(){t.loading=!1}))},save:function(){var t=this;if(!this.saveLoading){this.saveLoading=!0;var e=null;this.form.id?e=this.$http.put("backend/ad/"+this.form.id,this.form):(this.form.meeting_id=this.meetingId,e=this.$http.post("/backend/ad",this.form)),e.then((function(e){"success"===e.data.status&&(t.$message({message:e.data.info,type:"success"}),t.getList(),t.init(),t.dialogVisible=!1),t.saveLoading=!1})).catch((function(){t.saveLoading=!1}))}},edit:function(t){this.dialogVisible=!0,this.form=JSON.parse(JSON.stringify(t))},del:function(t){var e=this;this.$http.delete("/backend/ad/"+t).then((function(t){"success"===t.data.status&&(e.$message({message:t.data.info,type:"success"}),e.getList())}))},init:function(){JSON.parse(JSON.stringify(r))}}},c=l,u=a("2877"),p=Object(u["a"])(c,o,i,!1,null,"c2fb6a9c",null);e["default"]=p.exports},e154:function(t,e,a){"use strict";var o=a("6005"),i=a.n(o);i.a}}]);
//# sourceMappingURL=chunk-3f182386.8e6a6946.js.map